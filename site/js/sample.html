<!DOCTYPE html>
<html>
  <head>
    <style>
       #map {
        height: 800px;
        width: 100%;
       }
    </style>
  </head>
  <body>
    <h3>My Google Maps Demo</h3>
    <div id="map"></div>
    <a href = "#" onClick = "loadTable()"> Show me the table</a>	  
    <script>
	var map;
	function initMap() {
        	var location = {lat: 55.700, lng: 37.600};
        	var uluru = {lat: -25.363, lng: 131.044};
        	map = new google.maps.Map(document.getElementById('map'), {
        	  zoom: 4,
       		  center: location
        	});
        var marker = new google.maps.Marker({
          position: uluru,
          map: map,
          draggable: true,
          animation: google.maps.Animation.DROP,
          title: 'Marker'
        });
        var marker2 = new google.maps.Marker({ 
          position: location,
          map: map,
          draggable: true,
          title: 'Second Marker' 
        });
        var contentString = 'Hello! I am the Marker. Move me :)';
        var infowindow = new google.maps.InfoWindow({
          content: contentString
        });
        marker.addListener('click', function() {
          infowindow.open(map, marker);
       });
	marker2.addListener('click', function() {
          infowindow.open(map, marker2);
       });      
	google.maps.event.addListener(marker, 'position_changed', update);
  	google.maps.event.addListener(marker2, 'position_changed', update);      
	      
        var flightPlanCoordinates = [
       marker.getPosition(), 
       marker2.getPosition()
        ];
        var flightPath = new google.maps.Polyline( {
        path: flightPlanCoordinates, 
        geodesic: true,
	draggable: true,
        strokeColor: '#FF0000',
      	strokeOpacity: 1.0,
      	strokeWeight: 2
    } );

  	flightPath.setMap(map);
	update();
function update() {
  var path = [marker.getPosition(), marker2.getPosition()];
  flightPath.setPath(path);
}
      }
</script>
	
<input type = "text" id = "tableId"></input>
<script>
	var v = document.getElementById("tableId");
	function listMajors() {
        gapi.client.sheets.spreadsheets.values.get({
        	spreadsheetId: v.value,
        	range: 'Class Data!A2:E',
        }).then(function(response) {
        	var range = response.result;
        if (range.values.length > 0) {
        	appendPre('Name, Major:');
        for (i = 0; i < range.values.length; i++) {
        	var row = range.values[i];
         	// Print columns A and E, which correspond to indices 0 and 4.
              	appendPre(row[0] + ', ' + row[4]);
       		}
          } else {
            appendPre('No data found.');
          }
        }, function(response) {
          appendPre('Error: ' + response.result.error.message);
        });
      }	
</script>
	  
 <script type = "application/javascript" src = "first.js">
    </script>  
	  
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDA6tIfdstDmqeKNMhA_tWYo4Xm0oYizc0&callback=initMap&&libraries=geometry">
    </script>
  </body>
</html>
